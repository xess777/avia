# avia

## Сборка через docker-compose
```console
docker-compose build
docker-compose up
```

## Общая информация
**Используемые инструменты:**
* python 3.7
* [falcon](https://github.com/falconry/falcon)
* [marshmallow](https://github.com/marshmallow-code/marshmallow)

**Комментарии:**
1. В требованиях нет критериев и формулы как должна рассчитываться оптимальность.
Для расчета оптимальности использовались два параметра: стоимость и длительность перелета. При этом стоимость имеет больший вес, чем длительность.

2. Также неполно сформулировано как сравнивать результаты двух запросов.
Поэтому был выбран вариант сравнивать лучшие предложения из двух запросов. При этом лучшее определяется по определенному параметру, например, самое дешевое/дороге, быстрое/долгое.

## Описание API

**Методы выборки данных (GET):**

**1. Получение предложений о перелётах из DXB в BKK: /proposals/**

В теле ответа ожидается структура `{"proposals": [ ... ]}` с вариантами перелётов.
По умолчанию выводятся все варианты без сортировки.

GET-параметры:
* **limit** - лимит записей
* **order_by** - параметр, по которому сортируем записи. Возможные значения:
    * **adult_prize** - сортируем по стоимости для взрослого пассажира (от меньшего к большему)
    * **child_prize** - сортируем по стоимости для ребёнка (от меньшего к большему)
    * **infant_prize** - сортируем по стоимости для младенца (от меньшего к большему)
    * **duration** - сортируем по длительности перелёта (от меньшего к большему)
    * **optimality** - сортируем по оптимальности (от лучших к худшим)
* **reverse** - меняет порядок сортировки на обратный, если в значении true (по умолчанию false). Возможные значения:
    * ('true', 'True', 'yes', '1', 'on') - true
    * ('false', 'False', 'no', '0', 'off') - false

Пример запроса: `http://localhost/proposals?order_by=optimality&limit=10`

**2. Отличия между результатами двух запросов : /difference/**

В теле ответа ожидается структура с отличиями лучших предложений из двух запросов следующего вида:

```json
{
    "adult_prize_diff": "разница в цене для одного взрослого",
    "child_prize_diff": "разница в цене для одного ребенка",
    "infant_prize_diff": "разница в цене для одного младенца",
    "duration_diff": "разница в длительности маршрута",
    "via3_segments_airports": "маршрут из RS_Via-3.xml",
    "via_ow_segments_airports": "маршрут из RS_ViaOW.xml",
}
```

GET-параметры:
* **order_by** - параметр, по которому сортируем записи. Возможные значения:
    * **adult_prize** - сортируем по стоимости для взрослого пассажира (от меньшего к большему)
    * **child_prize** - сортируем по стоимости для ребёнка (от меньшего к большему)
    * **infant_prize** - сортируем по стоимости для младенца (от меньшего к большему)
    * **duration** - сортируем по длительности перелёта (от меньшего к большему)
* **reverse** - меняет порядок сортировки на обратный, если в значении true (по умолчанию false). Возможные значения:
    * ('true', 'True', 'yes', '1', 'on') - true
    * ('false', 'False', 'no', '0', 'off') - false

Пример запроса: `http://localhost/difference?order_by=adult_prize&reverse=true`
